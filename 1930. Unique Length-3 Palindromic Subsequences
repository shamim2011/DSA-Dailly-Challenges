//Approach-1 First & Last Occurrence by Iteration
//T.C : O(n)
//S.C : O(1) - ONly 26 sized always


class Solution {
    public int countPalindromicSubsequence(String s) {
        int n = s.length(); // Length of the string
        int ans = 0; // Stores final answer
        
        Set<Character> uniqueCharSet = new HashSet<>();
        
        // Step 1: Add all unique characters from string into set
        for(char ch : s.toCharArray()) {
            uniqueCharSet.add(ch);
        }
        
        // Step 2: For each unique character, treat it as the first and last char of palindrome
        for(char ch : uniqueCharSet) {
            int firstIdx = -1;
            int lastIdx = -1;
            
            // Find first and last occurrence of this character
            for(int i = 0; i < n; i++) {
                if(ch == s.charAt(i)) {
                    if(firstIdx == -1) firstIdx = i; // first time occurrence
                    lastIdx = i; // keep updating for last occurrence
                }
            }
            
            // Step 3: Collect all unique characters between first and last occurrence
            Set<Character> st = new HashSet<>();
            for(int idx = firstIdx + 1; idx <= lastIdx - 1; idx++) {
                st.add(s.charAt(idx));
            }
            
            // Number of unique characters in between contributes to palindrome count
            ans += st.size();
        }
        
        return ans; // Return total palindromic subsequences of length 3
    }
}



//Approach-2 (Storing first and last indices before hand
//T.C : O(n)
//S.C : O(1) - Only 26 sized always



class Solution {
    public int countPalindromicSubsequence(String s) {
        int n = s.length();
        int ans = 0;
        
        // Arrays to store first and last occurrences of each character
        // Index 0 for 'a', 1 for 'b', ..., 25 for 'z'
        int[] first = new int[26];
        int[] last = new int[26];
        
        // Initialize with -1 because no index visited yet
        Arrays.fill(first, -1);
        Arrays.fill(last, -1);
        
        // Step 1: Fill first and last occurrence arrays
        for(int i = 0; i < n; i++) {
            int curr = s.charAt(i) - 'a';
            
            // If seeing this character first time, mark first index
            if(first[curr] == -1) {
                first[curr] = i;
            }
            
            // Always update last index
            last[curr] = i;
        }
        
        // Step 2: For each character from 'a' to 'z'
        for(int i = 0; i < 26; i++) {
            
            // Skip characters not present in string
            if(first[i] == -1) continue;
            
            // Set to collect unique middle characters
            Set<Character> st = new HashSet<>();
            
            // Collect characters between first and last occurrence
            for(int idx = first[i] + 1; idx < last[i]; idx++) {
                st.add(s.charAt(idx));
            }
            
            // Add number of unique middle characters
            ans += st.size();
        }
        
        return ans; // Total palindromic subsequences of length 3
    }
}

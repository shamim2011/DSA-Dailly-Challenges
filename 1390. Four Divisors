// Approach - 1 : Brute Force Divisor Counting (TLE)
// T.C - O(N * M)              N = number of elements in nums, M = maximum value in nums
// S.C - O(1)


class Solution {

    // Main function to calculate the sum of divisors
    // for numbers having exactly four divisors
    public int sumFourDivisors(int[] nums) {
        int ans = 0;

        // Traverse each number in the array
        for (int num : nums) {

            // Check if the number has exactly four divisors
            boolean countDivi = isFourDivisors(num);

            // If yes, add the sum of all its divisors
            if (countDivi) {
                ans += sumOfAllDivi(num);
            }
        }

        return ans;
    }

    // Function to check whether a number has exactly four divisors
    boolean isFourDivisors(int n) {
        int count = 0;

        // Check divisibility from 1 to n
        for (int i = 1; i <= n; i++) {

            // If i divides n, increase divisor count
            if (n % i == 0) {
                count++;
            }

            // Early stopping if divisors exceed 4
            if (count > 4) {
                return false;
            }
        }

        // Return true only if divisor count is exactly 4
        return count == 4;
    }

    // Function to calculate the sum of all divisors of a number
    int sumOfAllDivi(int n) {
        int sum = 0;

        // Traverse from 1 to n and add divisors
        for (int i = 1; i <= n; i++) {
            if (n % i == 0) {
                sum += i;
            }
        }

        return sum;
    }
}




// Approach - 2 : Divisor Counting Using Square Root Iteration
// T.C - O(NÃ—sqrt(M))           N = number of elements in nums, M = maximum value in nums
// S.C - O(1)


class Solution {

    // This method iterates over each number in the array
    // and adds the sum of its divisors only if it has exactly 4 divisors
    public int sumFourDivisors(int[] nums) {
        int ans = 0;

        // Process each number in the array
        for (int num : nums) {
            ans += sumOfAllDivi(num);
        }

        return ans;
    }

    // This helper method returns:
    // - the sum of all divisors if the number has exactly 4 divisors
    // - otherwise returns 0
    int sumOfAllDivi(int n) {
        int sum = 0;    // To store sum of divisors
        int count = 0;  // To count number of divisors

        // Iterate till sqrt(n) to find divisor pairs
        for (int i = 1; i * i <= n; i++) {

            // If i is a divisor
            if (n % i == 0) {
                int d1 = i;      // First divisor
                int d2 = n / i;  // Corresponding paired divisor

                // Count and add first divisor
                count++;
                sum += d1;

                // If divisors are different, count and add second divisor
                if (d1 != d2) {
                    count++;
                    sum += d2;
                }

                // If divisors exceed 4, no need to continue
                if (count > 4) return 0;
            }
        }

        // Return sum only if exactly 4 divisors are found
        return count == 4 ? sum : 0;
    }
}
